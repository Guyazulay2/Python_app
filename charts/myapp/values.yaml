# charts/myapp/values.yaml - מותאם להרצה מקומית ב-Minikube (כולל Agent)

# ========================================================
# הגדרות Backend (FastAPI)
# ========================================================
backend:
  # שימוש בתמונות המקומיות שבנינו (local/backend-app)
  image: local/backend-app
  tag: latest
  imagePullPolicy: IfNotPresent 
  
  # סודות (נשארים ריקים ונדרסים בהרצה עם --set)
  secrets:
    DB_USER: "" 
    DB_PASSWORD: "" 
    
  replicaCount: 1

# ========================================================
# הגדרות Frontend (React/Nginx)
# ========================================================
frontend:
  # שימוש בתמונות המקומיות שבנינו (local/frontend-app)
  image: local/frontend-app
  tag: latest
  imagePullPolicy: IfNotPresent
  replicaCount: 1

# ========================================================
# **חדש:** הגדרות Agent (איסוף נתונים)
# ========================================================
agent:
  # שימוש בתמונות המקומיות שבנינו (local/agent-app)
  image: local/agent-app
  tag: latest
  imagePullPolicy: IfNotPresent
  
  # ה-Master URL פונה לשם ה-Service הפנימי של ה-Backend ב-Kubernetes
  masterUrl: "http://backend:80/api/agent/data" 
  
  # הערה: יש לוודא שקובץ ה-Deployment של ה-Agent 
  # יכלול את ה-hostPath volumes ואת הרשאות ה-Privileged Security Context 
  # הדרושות לקונטיינר מסוג זה (בדומה ל-docker-compose).

# ========================================================
# הגדרות PostgreSQL
# ========================================================
postgres:
  image: postgres:15-alpine
  serviceName: my-postgres-service 
  
  persistence:
    # **תיקון חיוני ל-Minikube:** השבתת PVC
    enabled: false
    # **תיקון חיוני ל-Minikube:** שימוש ב-StorageClass ריק
    storageClass: "" 
    accessMode: ReadWriteOnce
    size: 5Gi
    
  database:
    # שם הדאטהבייס שנקבע ב-docker-compose וב-backend/database.py
    name: mydb